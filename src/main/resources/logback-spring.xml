<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <springProfile name="dev">
        <!-- This file is local logging configuration so if you want to use change name of as logback-spring and restart -->
        <property name="HOME_LOG_PATH" value="/tmp/ozan_exchange/logs"/>
        <property name="PATTERN_CONSOLE"
                  value=".%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg %n"/>
        <property name="PATTERN_ROLLING_FILE" value="%d %p %c{1.} [%t] %m%n"/>
        <property name="PATTERN_FILE" value="%-4relative [%thread] %-5level %logger{35} - %msg%n"/>
        <property name="MAX_FILE_SIZE" value="100MB"/>
        <property name="MAX_DAY_KEEP" value="30"/>

        <appender name="consoleAppender" class="ch.qos.logback.core.ConsoleAppender">
            <encoder>
                <Pattern>${PATTERN_CONSOLE}</Pattern>
            </encoder>
            <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
                <level>TRACE</level>
            </filter>
        </appender>

        <appender name="fileRollingAppender"
                  class="ch.qos.logback.core.rolling.RollingFileAppender">
            <file>${HOME_LOG_PATH}/application.log</file>

            <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                <fileNamePattern>${HOME_LOG_PATH}/app.%d{yyyy-MM-dd_HH-mm}.%i.log</fileNamePattern>
                <!-- each archived file, size max 100MB -->
                <maxFileSize>${MAX_FILE_SIZE}</maxFileSize>
                <!-- total size of all archive files, if total size > 20GB,
                    it will delete old archived file -->
                <totalSizeCap>250MB</totalSizeCap>
                <!-- 30 days to keep -->
                <maxHistory>${MAX_DAY_KEEP}</maxHistory>
            </rollingPolicy>

            <encoder>
                <pattern>${PATTERN_ROLLING_FILE}</pattern>
            </encoder>
        </appender>


        <logger name="defaultErrorFileLogger" level="error" additivity="false">
            <appender-ref ref="fileRollingAppender"/>
            <appender-ref ref="consoleAppender"/>
        </logger>

        <root level="info">
            <appender-ref ref="consoleAppender"/>
        </root>
    </springProfile>


    <springProfile name="prod">


        <appender name="loggly" class="ch.qos.logback.ext.loggly.LogglyAppender">
            <endpointUrl>
                https://logs-01.loggly.com/inputs/d81fa134-a4ce-41b2-812e-e4a0054ca172/tag/logback
            </endpointUrl>
            <pattern>%d{"ISO8601", UTC} %p %t %c{0}.%M - %m%n</pattern>
        </appender>


        <root level="info">
            <appender-ref ref="loggly"/>
        </root>

    </springProfile>

</configuration>